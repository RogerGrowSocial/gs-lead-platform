<%
  const pageContent = `
  <div class="banking-page main-container">
    <div id="bankingConnectBanner" class="banking-connect-banner" style="display:none"></div>
    <header class="banking-header">
      <div>
        <h1 class="banking-title">Bankieren</h1>
        <p class="banking-subtitle" id="bankingSubtitle">AI Bankier â€“ transacties koppelen en boeken</p>
      </div>
      <div class="banking-header-actions">
        <div class="banking-filters" id="bankingFiltersWrap">
          <select id="bankingAccountSelect" class="banking-select" aria-label="Rekening">
            <option value="">Alle rekeningen</option>
          </select>
          <input type="date" id="bankingFromDate" class="banking-input" aria-label="Van datum">
          <input type="date" id="bankingToDate" class="banking-input" aria-label="Tot datum">
          <select id="bankingStatusSelect" class="banking-select" aria-label="Status">
            <option value="">Alle statussen</option>
            <option value="new">Te verwerken</option>
            <option value="suggested">Voorstel klaar</option>
            <option value="linked">Gekoppeld</option>
            <option value="posted">Afgehandeld</option>
            <option value="exception">Uitzondering</option>
          </select>
          <input type="search" id="bankingSearch" class="banking-input banking-search" placeholder="Zoeken..." aria-label="Zoeken">
        </div>
        <div class="banking-buttons">
          <button type="button" id="bankingPrimaryBtn" class="banking-btn banking-btn-primary">
            Koppel bankrekening
          </button>
          <div class="banking-more-wrap">
            <button type="button" id="bankingMoreBtn" class="banking-btn banking-btn-secondary" aria-haspopup="true" aria-expanded="false" title="Meer">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="6" r="1.5"/><circle cx="12" cy="12" r="1.5"/><circle cx="12" cy="18" r="1.5"/></svg>
            </button>
            <div id="bankingMoreMenu" class="banking-more-menu" role="menu" style="display:none">
              <a href="#" id="bankingImportFallback" class="banking-more-item" role="menuitem">Bankbestand importeren (fallback)</a>
              <a href="/admin/payments/banking/connections" class="banking-more-item" role="menuitem">Beheer koppelingen</a>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Empty state: geen gekoppelde rekening -->
    <div id="bankingEmptyConnect" class="banking-empty-connect" style="display:none">
      <div class="banking-empty-card">
        <h2>Koppel je bankrekening</h2>
        <p>Koppel je bankrekening en wij halen transacties automatisch op. Geen handmatige export meer nodig.</p>
        <div class="banking-empty-actions">
          <a href="/admin/payments/banking/rabobank/connect" id="bankingConnectRabobank" class="banking-btn banking-btn-primary">Koppel Rabobank</a>
          <button type="button" id="bankingManualImportLink" class="banking-btn banking-btn-secondary">Ik wil handmatig importeren</button>
        </div>
      </div>
    </div>

    <div class="banking-layout" id="bankingMainLayout" style="display:none">
      <section class="banking-list-panel" aria-label="Transactielijst">
        <div id="bankingListContainer" class="banking-list-container">
          <div id="bankingListLoading" class="banking-loading" style="display:none">Laden...</div>
          <div id="bankingListEmpty" class="banking-empty" style="display:none">
            <p>Geen transacties. Klik op &quot;Sync nu&quot; om transacties op te halen, of importeer een bankbestand via Meer.</p>
          </div>
          <table class="banking-table" id="bankingTable" style="display:none">
            <thead>
              <tr>
                <th><input type="checkbox" id="bankingSelectAll" aria-label="Alles selecteren"></th>
                <th>Datum</th>
                <th>Tegenrekening</th>
                <th>Omschrijving</th>
                <th class="banking-th-amount">Bedrag</th>
                <th>Status</th>
                <th>Voorstel</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="bankingTableBody"></tbody>
          </table>
        </div>
        <div id="bankingPagination" class="banking-pagination"></div>
      </section>

      <!-- Right slide-in drawer -->
      <div id="bankingDrawerOverlay" class="gs-drawer-overlay banking-drawer-overlay" aria-hidden="true"></div>
      <aside id="bankingDrawer" class="gs-drawer banking-drawer" role="dialog" aria-label="Transactie details" aria-hidden="true">
        <div class="gs-drawer__header banking-drawer-header">
          <div>
            <h2 class="gs-drawer__title" id="bankingDrawerTitle">Transactie</h2>
            <p class="gs-drawer__subtitle" id="bankingDrawerSubtitle"></p>
          </div>
          <button type="button" class="gs-drawer__close" data-drawer-close aria-label="Sluiten">&times;</button>
        </div>
        <div class="gs-drawer__body banking-drawer-body">
          <div id="bankingDrawerTabs" class="banking-drawer-tabs">
            <button type="button" class="banking-tab active" data-tab="voorstel">Voorstel</button>
            <button type="button" class="banking-tab" data-tab="details">Details</button>
            <button type="button" class="banking-tab" data-tab="audit">Audit</button>
          </div>
          <div id="bankingDrawerContent">
            <div id="bankingTabVoorstel" class="banking-tab-pane" data-pane="voorstel">
              <div id="bankingSuggestionBlock" class="banking-suggestion-block"></div>
              <div id="bankingApproveActions" class="banking-approve-actions">
                <button type="button" id="bankingApproveBtn" class="gs-form-btn-primary">Accepteren</button>
                <button type="button" id="bankingAdjustBtn" class="gs-form-btn-secondary">Aanpassen</button>
              </div>
            </div>
            <div id="bankingTabDetails" class="banking-tab-pane" data-pane="details" style="display:none">
              <dl id="bankingDetailsList" class="banking-details-dl"></dl>
              <details class="banking-raw-meta">
                <summary>Raw metadata</summary>
                <pre id="bankingRawJson"></pre>
              </details>
            </div>
            <div id="bankingTabAudit" class="banking-tab-pane" data-pane="audit" style="display:none">
              <div id="bankingAuditContent" class="banking-audit-content"></div>
            </div>
          </div>
        </div>
      </aside>
    </div>

    <!-- Import modal (fallback, via Meer) -->
    <div id="bankingImportModal" class="banking-modal" style="display:none" role="dialog" aria-label="Import">
      <div class="banking-modal-content">
        <h3>Importeer bankbestand</h3>
        <p>Selecteer een rekening en een bestand (CSV, MT940 of CAMT.053). Fallback als automatische sync niet beschikbaar is.</p>
        <form id="bankingImportForm">
          <div class="gs-form-group">
            <label class="gs-form-label" for="bankingImportAccount">Rekening</label>
            <select id="bankingImportAccount" class="gs-form-input" required></select>
          </div>
          <div class="gs-form-group">
            <label class="gs-form-label">Bestand</label>
            <input type="file" id="bankingImportFile" accept=".csv,.sta,.mt940,.xml" required>
          </div>
          <div id="bankingImportError" class="gs-error" style="display:none"></div>
          <div class="banking-modal-actions">
            <button type="submit" class="gs-form-btn-primary">Importeren</button>
            <button type="button" id="bankingImportCancel" class="gs-form-btn-secondary">Annuleren</button>
          </div>
        </form>
      </div>
    </div>
  </div>
`;
%>
<%- include('../../layouts/admin', {
  title: title || 'Bankieren',
  activeMenu: 'payments',
  activeSubmenu: 'banking',
  user: user,
  body: pageContent,
  stylesheets: typeof stylesheets !== 'undefined' ? stylesheets : ['/css/admin/adminPayments.css', '/css/admin/banking.css'],
  scripts: typeof scripts !== 'undefined' ? scripts : ['/js/admin/banking.js']
}) %>
